{"ast":null,"code":"import _defineProperty from\"C:/Users/Faisal/Desktop/fullstack Projects/Diary Software/my-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/Faisal/Desktop/fullstack Projects/Diary Software/my-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/Faisal/Desktop/fullstack Projects/Diary Software/my-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Faisal/Desktop/fullstack Projects/Diary Software/my-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Faisal\\\\Desktop\\\\fullstack Projects\\\\Diary Software\\\\my-frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from'react';import'./Expenditure.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Expenditure=function Expenditure(){var _useState=useState(function(){var today=new Date();var day=String(today.getDate()).padStart(2,'0');var month=String(today.getMonth()+1).padStart(2,'0');//January is 0!\n//January is 0!\nvar year=today.getFullYear();return\"\".concat(year,\"-\").concat(month,\"-\").concat(day);}),_useState2=_slicedToArray(_useState,2),date=_useState2[0],setDate=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),source=_useState4[0],setSource=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),amount=_useState6[0],setAmount=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),expenses=_useState8[0],setExpenses=_useState8[1];var _useState9=useState(-1),_useState10=_slicedToArray(_useState9,2),editIndex=_useState10[0],setEditIndex=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),showAlert=_useState12[0],setShowAlert=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),deleteIndex=_useState14[0],setDeleteIndex=_useState14[1];var _useState15=useState({}),_useState16=_slicedToArray(_useState15,2),groupVisibility=_useState16[0],setGroupVisibility=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),showMonthlySales=_useState18[0],setShowMonthlySales=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),globalVisibility=_useState20[0],setGlobalVisibility=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),showModal=_useState22[0],setShowModal=_useState22[1];// You already have this for controlling the visibility of the modal\nvar _useState23=useState(''),_useState24=_slicedToArray(_useState23,2),modalMessage=_useState24[0],setModalMessage=_useState24[1];// Add this line to manage the modal message\nvar _useState25=useState('English'),_useState26=_slicedToArray(_useState25,2),language=_useState26[0],setLanguage=_useState26[1];var translations={English:{title:\"Expenditure khata\",date:\"Date\",source:\"Source of Expense\",amount:\"Amount\",save:\"Save\",monthlyExpenseReport:\"Monthly Expense Report:\",overallExpenses:\"Overall Expenses:\",showAll:\"Show All\",hideAll:\"Hide All\",delete:\"Delete\",update:\"Update\",deletePrompt:\"Are you sure you want to delete this expense?\",yes:\"Yes\",no:\"No\",show:\"Show\",hide:\"Hide\",KiloMilk:\"Kilo Milk\",kaa:\"of\",added:\"has been added\",In:\"In\",enterSource:\"Enter source expense \",enterAmount:\"Enter amount of Expense\",expens:\"Expense\",record:\"Record has been updated\"},Urdu:{title:\"خرچے کا حساب\",date:\"تاریخ\",source:\"خرچے کا ذریعہ\",amount:\"رقم\",save:\"محفوظ کریں\",monthlyExpenseReport:\"ماہانہ خرچہ رپورٹ:\",overallExpenses:\"کل خرچے:\",showAll:\"سب دیکھیں\",hideAll:\"سب چھپائیں\",delete:\"حذف کریں\",update:\"اپ ڈیٹ\",deletePrompt:\"کیا آپ واقعی اس خرچے کو حذف کرنا چاہتے ہیں؟\",yes:\"ہاں\",no:\"نہیں\",show:\" دیکھیں\",hide:\" چھپائیں\",KiloMilk:\"کلو دودھ\",kaa:\"کا\",added:\" شامل ہوگیا ہے\",In:\"میں\",enterSource:\"خرچے کا ذریعہ درج کریں\",enterAmount:\"خرچے کی رقم درج کریں\",expens:'اخراجات',record:\"ریکارڈ اپ ڈیٹ ہو گیا ہے\"}};var monthTranslations={January:\"جنوری\",February:\"فروری\",March:\"مارچ\",April:\"اپریل\",May:\"مئی\",June:\"جون\",July:\"جولائی\",August:\"اگست\",September:\"ستمبر\",October:\"اکتوبر\",November:\"نومبر\",December:\"دسمبر\"};var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,data,processedData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch('http://localhost:3001/expenditure');case 3:response=_context.sent;if(response.ok){_context.next=6;break;}throw new Error(\"HTTP error! status: \".concat(response.status));case 6:_context.next=8;return response.json();case 8:data=_context.sent;processedData=data.map(function(expense){return _objectSpread(_objectSpread({},expense),{},{amount:parseFloat(expense.amount)});});setExpenses(processedData);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.error('There was an error fetching the sales data:',_context.t0);case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();useEffect(function(){fetchData();},[]);var toggleGroupVisibility=function toggleGroupVisibility(monthYear){setGlobalVisibility(function(prevGlobalState){if(!prevGlobalState){// If global visibility is off, ensure it stays off and don't toggle individual groups\nconsole.warn(\"Global visibility is off. Can't toggle individual group visibility.\");return prevGlobalState;}// If global visibility is on, toggle the specific month/year group\nsetGroupVisibility(function(prevGroupVisibility){return _objectSpread(_objectSpread({},prevGroupVisibility),{},_defineProperty({},monthYear,!prevGroupVisibility[monthYear]));});return prevGlobalState;// Return the unchanged global state\n});};var CustomModal=function CustomModal(_ref2){var message=_ref2.message,onClose=_ref2.onClose;return/*#__PURE__*/_jsx(\"div\",{className:\"custom-modal-overlay\",children:/*#__PURE__*/_jsx(\"div\",{className:\"custom-modal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom-modal-content\",children:[/*#__PURE__*/_jsx(\"p\",{children:message}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,children:\"Close\"})]})})});};// Group expenses by month and year\nvar groupedExpenses=expenses.reduce(function(acc,expense){// Ensure the date string is in the correct format (YYYY-MM-DD)\nvar expenseDate=expense.Date;// Adjust if the API gives a different property name for the date\nvar date=new Date(expenseDate);if(isNaN(date.getTime())){console.error('Invalid date for expense:',expense);return acc;// Skip this expense if the date is invalid\n}var monthYear=\"\".concat(date.toLocaleString('default',{month:'long',year:'numeric'}));if(!acc[monthYear]){acc[monthYear]=[];}acc[monthYear].push(expense);return acc;},{});var handleSave=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var expensePayload,response,expenseId,monthYear,alertMessage,_monthYear,_alertMessage;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();expensePayload={Date:date,source:source,amount:parseFloat(amount)};_context2.prev=2;if(!(editIndex>=0)){_context2.next=14;break;}// Assuming your expense objects use 'idConsumersSale' as the key for ID\nexpenseId=expenses[editIndex].idexpenditure;// Adjust this line accordingly\n_context2.next=7;return fetch(\"http://localhost:3001/expenditure/\".concat(expenseId),{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify(expensePayload)});case 7:response=_context2.sent;monthYear=new Date(date).toLocaleString('default',{month:'long',year:'numeric'});alertMessage=\"\".concat(translations[language].record,\" \");// Replace alert(alertMessage); with:\nsetModalMessage(alertMessage);setShowModal(true);_context2.next=21;break;case 14:_context2.next=16;return fetch('http://localhost:3001/expenditure',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(expensePayload)});case 16:response=_context2.sent;_monthYear=new Date(date).toLocaleString('default',{month:'long',year:'numeric'});_alertMessage=\"\".concat(amount,\" \").concat(translations[language].expens,\" \").concat(translations[language].added,\" \");// Replace alert(alertMessage); with:\nsetModalMessage(_alertMessage);setShowModal(true);case 21:if(response.ok){_context2.next=23;break;}throw new Error(\"HTTP error! status: \".concat(response.status));case 23:_context2.next=25;return fetchData();case 25:// Refresh data\nsetSource('');setAmount('');setEditIndex(-1);_context2.next=33;break;case 30:_context2.prev=30;_context2.t0=_context2[\"catch\"](2);console.error('There was an error saving the sale:',_context2.t0);case 33:case\"end\":return _context2.stop();}}},_callee2,null,[[2,30]]);}));return function handleSave(_x){return _ref3.apply(this,arguments);};}();var toggleGlobalVisibility=function toggleGlobalVisibility(){setGlobalVisibility(function(prevState){var newState=!prevState;// Update all group visibilities based on the new global state\nvar newGroupVisibility=Object.keys(groupVisibility).reduce(function(acc,key){acc[key]=newState;// Show or hide all based on the new global state\nreturn acc;},{});setGroupVisibility(newGroupVisibility);return newState;});};var toggleMonthlySalesVisibility=function toggleMonthlySalesVisibility(){setShowMonthlySales(function(prevShow){return!prevShow;});// Toggle the visibility state\n};var handleDelete=function handleDelete(index){setShowAlert(true);setDeleteIndex(index);};var handleAlertConfirm=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(isConfirmed){var expense,response,result;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(isConfirmed&&deleteIndex!=null)){_context3.next=23;break;}expense=expenses[deleteIndex];if(!(expense&&expense.idexpenditure)){_context3.next=22;break;}_context3.prev=3;_context3.next=6;return fetch(\"http://localhost:3001/expenditure/\".concat(expense.idexpenditure),{method:'DELETE',headers:{'Content-Type':'application/json'}});case 6:response=_context3.sent;if(response.ok){_context3.next=9;break;}throw new Error(\"HTTP error! status: \".concat(response.status));case 9:_context3.next=11;return response.json();case 11:result=_context3.sent;console.log(result.message);// Log the message from the backend\n// Refresh the expenses list after deleting an expense\n_context3.next=15;return fetchData();case 15:_context3.next=20;break;case 17:_context3.prev=17;_context3.t0=_context3[\"catch\"](3);console.error('There was an error deleting the sale:',_context3.t0);case 20:_context3.next=23;break;case 22:console.error('Attempted to delete an expense without a valid ID');case 23:// Reset the state regardless of whether the delete was successful or not\nsetDeleteIndex(null);setShowAlert(false);case 25:case\"end\":return _context3.stop();}}},_callee3,null,[[3,17]]);}));return function handleAlertConfirm(_x2){return _ref4.apply(this,arguments);};}();var getMonthlyExpenses=function getMonthlyExpenses(){return expenses.reduce(function(acc,expense){var expenseDate=new Date(expense.Date);// Adjust according to your actual data structure\nvar monthYear=\"\".concat(expenseDate.toLocaleString('default',{month:'long'}),\" \").concat(expenseDate.getFullYear());var expenseAmount=isNaN(parseFloat(expense.amount))?0:parseFloat(expense.amount);if(!acc[monthYear])acc[monthYear]=0;acc[monthYear]+=expenseAmount;return acc;},{});};var getOverallExpenses=function getOverallExpenses(){return expenses.reduce(function(acc,expense){return acc+expense.amount;},0);};var handleUpdate=function handleUpdate(index){var expense=expenses[index];// Correctly assign values from the expense object\nsetDate(expense.Date);// Ensure the property names match your data structure\nsetSource(expense.source);// This should be the source, not the total or any other field\nsetAmount(expense.amount.toString());setEditIndex(index);};return/*#__PURE__*/_jsxs(\"div\",{className:\"expenditure-container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"expenditure-title\",children:translations[language].title}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setLanguage(function(lang){return lang==='English'?'Urdu':'English';});},className:\"language-toggle\",children:language==='English'?'اردو':'English'}),/*#__PURE__*/_jsxs(\"form\",{className:\"expenditure-form\",onSubmit:handleSave,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"date\",className:\"expenditure-label\",children:translations[language].date}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",id:\"date\",value:date,onChange:function onChange(e){return setDate(e.target.value);},className:\"expenditure-input date-input\",required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"source\",className:\"expenditure-label\",children:translations[language].source}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"source\",value:source,onChange:function onChange(e){return setSource(e.target.value);},className:\"expenditure-input\",placeholder:translations[language].enterSource,required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"amount\",className:\"expenditure-label\",children:translations[language].amount}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"amount\",value:amount,onChange:function onChange(e){return setAmount(e.target.value);},className:\"expenditure-input\",placeholder:translations[language].enterAmount,required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"save-button\",children:translations[language].save})]}),showModal&&/*#__PURE__*/_jsx(CustomModal,{message:modalMessage,onClose:function onClose(){return setShowModal(false);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"expenses-report\",children:[/*#__PURE__*/_jsx(\"h4\",{children:translations[language].monthlyExpenseReport}),/*#__PURE__*/_jsx(\"button\",{onClick:toggleMonthlySalesVisibility,className:\"toggle-all-button\",children:showMonthlySales?translations[language].hideAll:translations[language].showAll}),showMonthlySales&&Object.entries(getMonthlyExpenses()).map(function(_ref5){var _ref6=_slicedToArray(_ref5,2),monthYear=_ref6[0],total=_ref6[1];// Split month and year\nvar _monthYear$split=monthYear.split(' '),_monthYear$split2=_slicedToArray(_monthYear$split,2),month=_monthYear$split2[0],year=_monthYear$split2[1];// Translate the month name if available, otherwise, use the original name\nvar translatedMonth=language==='Urdu'?monthTranslations[month]||month:month;// Combine translated month and year\nvar translatedMonthYear=\"\".concat(translatedMonth,\" \").concat(year);return/*#__PURE__*/_jsxs(\"div\",{style:{color:'green'},children:[translations[language].monthlySales,\" \",translatedMonthYear,\" : \",total]},monthYear);}),/*#__PURE__*/_jsxs(\"h4\",{children:[translations[language].overallExpenses,/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{style:{color:'green'},children:getOverallExpenses()})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:toggleGlobalVisibility,className:\"global-toggle-button\",children:globalVisibility?translations[language].hideAll:translations[language].showAll}),globalVisibility&&Object.entries(groupedExpenses).map(function(_ref7){var _ref8=_slicedToArray(_ref7,2),monthYear=_ref8[0],expensesList=_ref8[1];return function(){var monthYearArray=monthYear.split(' ');var month=monthYearArray[0];var year=monthYearArray[1];// Translate the month name if the current language is Urdu\nvar translatedMonthName=language==='Urdu'?monthTranslations[month]||month:month;// Reconstruct the monthYear string with the possibly translated month name\nvar displayMonthYear=\"\".concat(translatedMonthName,\" \").concat(year);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{style:{marginTop:15},children:[displayMonthYear,/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return toggleGroupVisibility(monthYear);},className:\"toggle-button\",children:groupVisibility[monthYear]?translations[language].hide:translations[language].show})]}),groupVisibility[monthYear]&&/*#__PURE__*/_jsx(\"div\",{className:\"expenses-display\",children:expensesList.map(function(expense,index){var actualIndex=expenses.findIndex(function(e){return e===expense;});return/*#__PURE__*/_jsxs(\"div\",{className:\"expense-card\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[translations[language].date,\" : \",expense.Date]}),/*#__PURE__*/_jsxs(\"div\",{children:[translations[language].source,\" : \",expense.source]}),/*#__PURE__*/_jsxs(\"div\",{children:[translations[language].amount,\" : \",expense.amount]}),/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){return handleDelete(actualIndex);},className:\"delete-button1\",children:[translations[language].delete,\" \"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){return handleUpdate(actualIndex);},className:\"update-button\",children:[translations[language].update,\" \"]})]},index);})})]},monthYear);}();}),showAlert&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert-dialog\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[translations[language].deletePrompt,\" :\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){return handleAlertConfirm(true);},className:\"confirm-yes\",children:[translations[language].yes,\" \"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){return handleAlertConfirm(false);},className:\"confirm-no\",children:[translations[language].no,\" \"]})]})]});};export default Expenditure;","map":{"version":3,"sources":["C:/Users/Faisal/Desktop/fullstack Projects/Diary Software/my-frontend/src/Expenditure.jsx"],"names":["React","useState","useEffect","Expenditure","today","Date","day","String","getDate","padStart","month","getMonth","year","getFullYear","date","setDate","source","setSource","amount","setAmount","expenses","setExpenses","editIndex","setEditIndex","showAlert","setShowAlert","deleteIndex","setDeleteIndex","groupVisibility","setGroupVisibility","showMonthlySales","setShowMonthlySales","globalVisibility","setGlobalVisibility","showModal","setShowModal","modalMessage","setModalMessage","language","setLanguage","translations","English","title","save","monthlyExpenseReport","overallExpenses","showAll","hideAll","delete","update","deletePrompt","yes","no","show","hide","KiloMilk","kaa","added","In","enterSource","enterAmount","expens","record","Urdu","monthTranslations","January","February","March","April","May","June","July","August","September","October","November","December","fetchData","fetch","response","ok","Error","status","json","data","processedData","map","expense","parseFloat","console","error","toggleGroupVisibility","monthYear","prevGlobalState","warn","prevGroupVisibility","CustomModal","message","onClose","groupedExpenses","reduce","acc","expenseDate","isNaN","getTime","toLocaleString","push","handleSave","e","preventDefault","expensePayload","expenseId","idexpenditure","method","headers","body","JSON","stringify","alertMessage","toggleGlobalVisibility","prevState","newState","newGroupVisibility","Object","keys","key","toggleMonthlySalesVisibility","prevShow","handleDelete","index","handleAlertConfirm","isConfirmed","result","log","getMonthlyExpenses","expenseAmount","getOverallExpenses","handleUpdate","toString","lang","target","value","entries","total","split","translatedMonth","translatedMonthYear","color","monthlySales","expensesList","monthYearArray","translatedMonthName","displayMonthYear","marginTop","actualIndex","findIndex"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './Expenditure.css';\r\n\r\nconst Expenditure = () => {\r\n  const [date, setDate] = useState(() => {\r\n    const today = new Date();\r\n    const day = String(today.getDate()).padStart(2, '0');\r\n    const month = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!\r\n    const year = today.getFullYear();\r\n\r\n    return `${year}-${month}-${day}`;\r\n  });\r\n  const [source, setSource] = useState('');\r\n  const [amount, setAmount] = useState('');\r\n  const [expenses, setExpenses] = useState([]);\r\n  const [editIndex, setEditIndex] = useState(-1);\r\n  const [showAlert, setShowAlert] = useState(false);\r\n  const [deleteIndex, setDeleteIndex] = useState(null);\r\n  const [groupVisibility, setGroupVisibility] = useState({});\r\n  const [showMonthlySales, setShowMonthlySales] = useState(false);\r\n  const [globalVisibility, setGlobalVisibility] = useState(false);\r\n  const [showModal, setShowModal] = useState(false); // You already have this for controlling the visibility of the modal\r\n  const [modalMessage, setModalMessage] = useState(''); // Add this line to manage the modal message\r\n  const [language, setLanguage] = useState('English');\r\n\r\n  const translations = {\r\n\r\n    English: {\r\n      title: \"Expenditure khata\",\r\n      date: \"Date\",\r\n      source: \"Source of Expense\",\r\n      amount: \"Amount\",\r\n      save: \"Save\",\r\n      monthlyExpenseReport: \"Monthly Expense Report:\",\r\n      overallExpenses: \"Overall Expenses:\",\r\n      showAll: \"Show All\",\r\n      hideAll: \"Hide All\",\r\n      delete: \"Delete\",\r\n      update: \"Update\",\r\n      deletePrompt: \"Are you sure you want to delete this expense?\",\r\n      yes: \"Yes\",\r\n      no: \"No\",\r\n      show: \"Show\",\r\n      hide: \"Hide\",\r\n      KiloMilk: \"Kilo Milk\",\r\n      kaa: \"of\",\r\n      added: \"has been added\",\r\n      In: \"In\",\r\n      enterSource :\"Enter source expense \",\r\n      enterAmount: \"Enter amount of Expense\",\r\n      expens : \"Expense\",\r\n   \r\n      record: \"Record has been updated\",\r\n    },\r\n    Urdu: {\r\n      title: \"خرچے کا حساب\",\r\n      date: \"تاریخ\",\r\n      source: \"خرچے کا ذریعہ\",\r\n      amount: \"رقم\",\r\n      save: \"محفوظ کریں\",\r\n      monthlyExpenseReport: \"ماہانہ خرچہ رپورٹ:\",\r\n      overallExpenses: \"کل خرچے:\",\r\n      showAll: \"سب دیکھیں\",\r\n      hideAll: \"سب چھپائیں\",\r\n      delete: \"حذف کریں\",\r\n      update: \"اپ ڈیٹ\",\r\n      deletePrompt: \"کیا آپ واقعی اس خرچے کو حذف کرنا چاہتے ہیں؟\",\r\n      yes: \"ہاں\",\r\n      no: \"نہیں\",\r\n      show: \" دیکھیں\",\r\n      hide: \" چھپائیں\",\r\n      KiloMilk: \"کلو دودھ\",\r\n      kaa: \"کا\",\r\n      added: \" شامل ہوگیا ہے\",\r\n      In: \"میں\",\r\n      enterSource: \"خرچے کا ذریعہ درج کریں\",\r\n      enterAmount: \"خرچے کی رقم درج کریں\",\r\n      expens : 'اخراجات',\r\n      record: \"ریکارڈ اپ ڈیٹ ہو گیا ہے\",\r\n    },\r\n\r\n  };\r\n\r\n  const monthTranslations = {\r\n    January: \"جنوری\",\r\n    February: \"فروری\",\r\n    March: \"مارچ\",\r\n    April: \"اپریل\",\r\n    May: \"مئی\",\r\n    June: \"جون\",\r\n    July: \"جولائی\",\r\n    August: \"اگست\",\r\n    September: \"ستمبر\",\r\n    October: \"اکتوبر\",\r\n    November: \"نومبر\",\r\n    December: \"دسمبر\",\r\n  };\r\n  const fetchData = async () => {\r\n    try {\r\n      const response = await fetch('http://localhost:3001/expenditure');\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`);\r\n      }\r\n      const data = await response.json();\r\n      const processedData = data.map(expense => ({\r\n        ...expense,\r\n        amount: parseFloat(expense.amount),\r\n\r\n      }));\r\n      setExpenses(processedData);\r\n    } catch (error) {\r\n      console.error('There was an error fetching the sales data:', error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  const toggleGroupVisibility = (monthYear) => {\r\n    setGlobalVisibility(prevGlobalState => {\r\n      if (!prevGlobalState) {\r\n        // If global visibility is off, ensure it stays off and don't toggle individual groups\r\n        console.warn(\"Global visibility is off. Can't toggle individual group visibility.\");\r\n        return prevGlobalState;\r\n      }\r\n\r\n      // If global visibility is on, toggle the specific month/year group\r\n      setGroupVisibility(prevGroupVisibility => ({\r\n        ...prevGroupVisibility,\r\n        [monthYear]: !prevGroupVisibility[monthYear]\r\n      }));\r\n\r\n      return prevGlobalState; // Return the unchanged global state\r\n    });\r\n  };\r\n  const CustomModal = ({ message, onClose }) => {\r\n    return (\r\n      <div className=\"custom-modal-overlay\">\r\n        <div className=\"custom-modal\">\r\n          <div className=\"custom-modal-content\">\r\n            <p>{message}</p>\r\n            <button onClick={onClose}>Close</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n  // Group expenses by month and year\r\n  const groupedExpenses = expenses.reduce((acc, expense) => {\r\n    // Ensure the date string is in the correct format (YYYY-MM-DD)\r\n    const expenseDate = expense.Date; // Adjust if the API gives a different property name for the date\r\n    const date = new Date(expenseDate);\r\n\r\n    if (isNaN(date.getTime())) {\r\n      console.error('Invalid date for expense:', expense);\r\n      return acc; // Skip this expense if the date is invalid\r\n    }\r\n\r\n    const monthYear = `${date.toLocaleString('default', { month: 'long', year: 'numeric' })}`;\r\n    if (!acc[monthYear]) {\r\n      acc[monthYear] = [];\r\n    }\r\n    acc[monthYear].push(expense);\r\n\r\n    return acc;\r\n  }, {});\r\n\r\n  const handleSave = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const expensePayload = {\r\n      Date: date,\r\n      source: source,\r\n\r\n      amount: parseFloat(amount),\r\n    };\r\n\r\n    try {\r\n      let response;\r\n      if (editIndex >= 0) {\r\n        // Assuming your expense objects use 'idConsumersSale' as the key for ID\r\n        const expenseId = expenses[editIndex].idexpenditure; // Adjust this line accordingly\r\n        response = await fetch(`http://localhost:3001/expenditure/${expenseId}`, {\r\n          method: 'PUT',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(expensePayload),\r\n        });\r\n\r\n        const monthYear = new Date(date).toLocaleString('default', { month: 'long', year: 'numeric' });\r\n        const alertMessage = `${translations[language].record} `;\r\n\r\n        // Replace alert(alertMessage); with:\r\n        setModalMessage(alertMessage);\r\n        setShowModal(true);\r\n\r\n\r\n      } else {\r\n        // Adding a new expense\r\n        response = await fetch('http://localhost:3001/expenditure', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(expensePayload),\r\n          \r\n        });\r\n\r\n        const monthYear = new Date(date).toLocaleString('default', { month: 'long', year: 'numeric' });\r\n        const alertMessage = `${amount} ${translations[language].expens} ${translations[language].added} `;\r\n        // Replace alert(alertMessage); with:\r\n        setModalMessage(alertMessage);\r\n        setShowModal(true);\r\n\r\n      }\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      await fetchData(); // Refresh data\r\n\r\n      setSource('');\r\n      setAmount('');\r\n      setEditIndex(-1);\r\n\r\n    \r\n    } catch (error) {\r\n      console.error('There was an error saving the sale:', error);\r\n    }\r\n  };\r\n  const toggleGlobalVisibility = () => {\r\n    setGlobalVisibility(prevState => {\r\n      const newState = !prevState;\r\n      // Update all group visibilities based on the new global state\r\n      const newGroupVisibility = Object.keys(groupVisibility).reduce((acc, key) => {\r\n        acc[key] = newState; // Show or hide all based on the new global state\r\n        return acc;\r\n      }, {});\r\n\r\n      setGroupVisibility(newGroupVisibility);\r\n      return newState;\r\n    });\r\n  };\r\n\r\n  const toggleMonthlySalesVisibility = () => {\r\n    setShowMonthlySales(prevShow => !prevShow); // Toggle the visibility state\r\n  };\r\n\r\n  const handleDelete = (index) => {\r\n    setShowAlert(true);\r\n    setDeleteIndex(index);\r\n  };\r\n\r\n  const handleAlertConfirm = async (isConfirmed) => {\r\n    if (isConfirmed && deleteIndex != null) {\r\n      const expense = expenses[deleteIndex];\r\n      if (expense && expense.idexpenditure) { // Make sure the ID field matches your data structure\r\n        try {\r\n          const response = await fetch(`http://localhost:3001/expenditure/${expense.idexpenditure}`, {\r\n            method: 'DELETE',\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n            },\r\n          });\r\n\r\n          if (!response.ok) {\r\n            throw new Error(`HTTP error! status: ${response.status}`);\r\n          }\r\n\r\n          const result = await response.json();\r\n          console.log(result.message); // Log the message from the backend\r\n\r\n          // Refresh the expenses list after deleting an expense\r\n          await fetchData();\r\n\r\n        } catch (error) {\r\n          console.error('There was an error deleting the sale:', error);\r\n        }\r\n      } else {\r\n        console.error('Attempted to delete an expense without a valid ID');\r\n      }\r\n    }\r\n\r\n    // Reset the state regardless of whether the delete was successful or not\r\n    setDeleteIndex(null);\r\n    setShowAlert(false);\r\n  };\r\n\r\n  const getMonthlyExpenses = () => {\r\n    return expenses.reduce((acc, expense) => {\r\n      const expenseDate = new Date(expense.Date); // Adjust according to your actual data structure\r\n      const monthYear = `${expenseDate.toLocaleString('default', { month: 'long' })} ${expenseDate.getFullYear()}`;\r\n      const expenseAmount = isNaN(parseFloat(expense.amount)) ? 0 : parseFloat(expense.amount);\r\n\r\n      if (!acc[monthYear]) acc[monthYear] = 0;\r\n      acc[monthYear] += expenseAmount;\r\n\r\n      return acc;\r\n    }, {});\r\n  };\r\n\r\n\r\n  const getOverallExpenses = () => {\r\n\r\n    return expenses.reduce((acc, expense) => acc + expense.amount, 0);\r\n  };\r\n\r\n  const handleUpdate = (index) => {\r\n    const expense = expenses[index];\r\n    // Correctly assign values from the expense object\r\n    setDate(expense.Date); // Ensure the property names match your data structure\r\n    setSource(expense.source); // This should be the source, not the total or any other field\r\n    setAmount(expense.amount.toString());\r\n    setEditIndex(index);\r\n  };\r\n\r\n  return (\r\n    <div className=\"expenditure-container\">\r\n      <h1 className=\"expenditure-title\">{translations[language].title}</h1>\r\n      <button onClick={() => setLanguage(lang => lang === 'English' ? 'Urdu' : 'English')} className=\"language-toggle\">\r\n        {language === 'English' ? 'اردو' : 'English'}\r\n      </button>\r\n      <form className=\"expenditure-form\" onSubmit={handleSave}>\r\n        <label htmlFor=\"date\" className=\"expenditure-label\">{translations[language].date}</label>\r\n        <input\r\n          type=\"date\"\r\n          id=\"date\"\r\n          value={date}\r\n          onChange={(e) => setDate(e.target.value)}\r\n          className=\"expenditure-input date-input\"\r\n          required\r\n        />\r\n\r\n        <label htmlFor=\"source\" className=\"expenditure-label\">{translations[language].source}</label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"source\"\r\n          value={source}\r\n          onChange={(e) => setSource(e.target.value)}\r\n          className=\"expenditure-input\"\r\n          placeholder={translations[language].enterSource}\r\n          required\r\n        />\r\n\r\n        <label htmlFor=\"amount\" className=\"expenditure-label\">{translations[language].amount}</label>\r\n        <input\r\n          type=\"number\"\r\n          id=\"amount\"\r\n          value={amount}\r\n          onChange={(e) => setAmount(e.target.value)}\r\n          className=\"expenditure-input\"\r\n          placeholder={translations[language].enterAmount}\r\n          required\r\n        />\r\n\r\n        <button type=\"submit\" className=\"save-button\">{translations[language].save}</button>\r\n      </form>\r\n      {showModal && (\r\n        <CustomModal\r\n          message={modalMessage}\r\n          onClose={() => setShowModal(false)}\r\n        />\r\n      )}\r\n      <div className=\"expenses-report\">\r\n        <h4>{translations[language].monthlyExpenseReport}</h4>\r\n\r\n        <button onClick={toggleMonthlySalesVisibility} className=\"toggle-all-button\">\r\n          {showMonthlySales ? translations[language].hideAll : translations[language].showAll}\r\n        </button>\r\n\r\n        {showMonthlySales && Object.entries(getMonthlyExpenses()).map(([monthYear, total]) => {\r\n          // Split month and year\r\n          const [month, year] = monthYear.split(' ');\r\n\r\n          // Translate the month name if available, otherwise, use the original name\r\n          const translatedMonth = language === 'Urdu' ? monthTranslations[month] || month : month;\r\n\r\n          // Combine translated month and year\r\n          const translatedMonthYear = `${translatedMonth} ${year}`;\r\n\r\n          return (\r\n            <div key={monthYear} style={{ color: 'green' }}>\r\n              {translations[language].monthlySales} {translatedMonthYear} : {total}\r\n            </div>\r\n          );\r\n        })}\r\n\r\n\r\n        <h4>{translations[language].overallExpenses}<br /><span style={{ color: 'green' }}>{getOverallExpenses()}</span></h4>\r\n      </div>\r\n      <button onClick={toggleGlobalVisibility} className=\"global-toggle-button\">\r\n        {globalVisibility ? translations[language].hideAll : translations[language].showAll}\r\n      </button>\r\n\r\n      {globalVisibility && Object.entries(groupedExpenses).map(([monthYear, expensesList]) => (\r\n        (() => {\r\n          const monthYearArray = monthYear.split(' ');\r\n          const month = monthYearArray[0];\r\n          const year = monthYearArray[1];\r\n\r\n          // Translate the month name if the current language is Urdu\r\n          const translatedMonthName = language === 'Urdu' ? (monthTranslations[month] || month) : month;\r\n\r\n          // Reconstruct the monthYear string with the possibly translated month name\r\n          const displayMonthYear = `${translatedMonthName} ${year}`;\r\n\r\n          return (\r\n            <div key={monthYear}>\r\n              <h3 style={{ marginTop: 15 }}>\r\n                {displayMonthYear}\r\n                <button\r\n                  onClick={() => toggleGroupVisibility(monthYear)}\r\n                  className=\"toggle-button\"\r\n                >\r\n                  {groupVisibility[monthYear] ? translations[language].hide : translations[language].show}\r\n                </button>\r\n              </h3>\r\n              {groupVisibility[monthYear] && (\r\n                <div className=\"expenses-display\">\r\n                  {expensesList.map((expense, index) => {\r\n                    const actualIndex = expenses.findIndex(e => e === expense);\r\n                    return (\r\n                      <div key={index} className=\"expense-card\">\r\n                        <div>{translations[language].date} : {expense.Date}</div>\r\n                        <div>{translations[language].source} : {expense.source}</div>\r\n                        <div>{translations[language].amount} : {expense.amount}</div>\r\n                        <button onClick={() => handleDelete(actualIndex)} className=\"delete-button1\">{translations[language].delete} </button>\r\n                        <button onClick={() => handleUpdate(actualIndex)} className=\"update-button\">{translations[language].update} </button>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n            </div>\r\n          );\r\n        })()\r\n      ))}\r\n      {showAlert && (\r\n        <div className=\"alert-dialog\">\r\n          <p>{translations[language].deletePrompt} :</p>\r\n          <button onClick={() => handleAlertConfirm(true)} className=\"confirm-yes\">{translations[language].yes} </button>\r\n          <button onClick={() => handleAlertConfirm(false)} className=\"confirm-no\" >{translations[language].no} </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Expenditure;\r\n"]},"metadata":{},"sourceType":"module"}